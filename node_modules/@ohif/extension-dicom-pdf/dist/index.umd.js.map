{"version":3,"file":"index.umd.js","sources":["../src/OHIFDicomPDFSopClassHandler.js","../src/OHIFComponentPlugin.js","../src/TypedArrayProp.js","../src/DicomPDFViewport.js","../src/OHIFDicomPDFViewport.js","../src/index.js"],"sourcesContent":["import { MODULE_TYPES, utils } from 'ohif-core';\n\n// TODO: Should probably use dcmjs for this\nconst SOP_CLASS_UIDS = {\n  ENCAPSULATED_PDF: '1.2.840.10008.5.1.4.1.1.104.1'\n};\n\nconst OHIFDicomPDFSopClassHandler = {\n  id: 'OHIFDicomPDFSopClassHandlerPlugin',\n  type: MODULE_TYPES.SOP_CLASS_HANDLER,\n  sopClassUids: [SOP_CLASS_UIDS.ENCAPSULATED_PDF],\n  getDisplaySetFromSeries(series, study, dicomWebClient, authorizationHeaders) {\n    const instance = series.getFirstInstance();\n\n    return {\n      plugin: 'pdf',\n      displaySetInstanceUid: utils.guid(),\n      wadoRoot: study.getData().wadoRoot,\n      wadoUri: instance.getData().wadouri,\n      sopInstanceUid: instance.getSOPInstanceUID(),\n      seriesInstanceUid: series.getSeriesInstanceUID(),\n      studyInstanceUid: study.getStudyInstanceUID(),\n      authorizationHeaders: authorizationHeaders\n    };\n  }\n};\n\nexport default OHIFDicomPDFSopClassHandler;\n","import React from 'react';\nimport PropTypes from \"prop-types\";\n\nfunction OHIFComponentPlugin(props) {\n  return (<React.Fragment>{props.children}</React.Fragment>);\n}\n\nOHIFComponentPlugin.propTypes = {\n  id: PropTypes.string.isRequired,\n  init: PropTypes.func.isRequired,\n  destroy: PropTypes.func.isRequired,\n  children: PropTypes.node\n};\n\nexport default OHIFComponentPlugin;\n","// https://github.com/facebook/prop-types/issues/69\n\nexport const TypedArrayProp = {\n  any: (props, propName, componentName) => {\n    let obj = props[propName];\n    if (!(obj instanceof Float64Array ||\n      obj instanceof Float32Array ||\n      obj instanceof Int32Array ||\n      obj instanceof Int16Array ||\n      obj instanceof Int8Array ||\n      obj instanceof Uint32Array ||\n      obj instanceof Uint16Array ||\n      obj instanceof Uint8Array ||\n      obj instanceof Uint8ClampedArray)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a typed array.'\n      );\n    }\n  },\n\n  float64: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Float64Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Float64Array.'\n      );\n    }\n  },\n\n  float32: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Float32Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Float32Array.'\n      );\n    }\n  },\n\n  float: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Float64Array ||\n      props[propName] instanceof Float32Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Float32Array or Float64Array.'\n      );\n    }\n  },\n\n  int32: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Int32Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected an Int32Array.'\n      );\n    }\n  },\n\n  int16: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Int16Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected an In16Array.'\n      );\n    }\n  },\n\n  int8: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Int8Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected an Int8Array.'\n      );\n    }\n  },\n\n  int: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Int32Array ||\n      props[propName] instanceof Int16Array ||\n      props[propName] instanceof Int8Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected an Int32Array, In16Array, or Int8Array.'\n      );\n    }\n  },\n\n  uint32: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Uint32Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Uint32Array.'\n      );\n    }\n  },\n\n  uint16: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Uint16Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Uint16Array.'\n      );\n    }\n  },\n\n  uint8: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Uint8Array)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Uint8Array.'\n      );\n    }\n  },\n\n  uint8clamped: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Uint8ClampedArray)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Uint8ClampedArray.'\n      );\n    }\n  },\n\n  uint: (props, propName, componentName) => {\n    if (!(props[propName] instanceof Uint32Array ||\n      props[propName] instanceof Uint16Array ||\n      props[propName] instanceof Uint8Array ||\n      props[propName] instanceof Uint8ClampedArray)) {\n      return new Error(\n        'Invalid prop `' + propName + '` supplied to' +\n        ' `' + componentName + '`. Expected a Uint32Array, Uint16Array, Uint8Array, or Uint8ClampedArray.'\n      );\n    }\n  },\n};\n\nexport { TypedArrayProp as default };\n","import React, { Component } from 'react';\nimport dicomParser from 'dicom-parser';\nimport TypedArrayProp from './TypedArrayProp';\n\n// TODO: Should probably use dcmjs for this\nconst SOP_CLASS_UIDS = {\n  ENCAPSULATED_PDF: '1.2.840.10008.5.1.4.1.1.104.1'\n};\n\nclass DicomPDFViewport extends Component {\n  state = {\n    fileURL: null,\n    error: null\n  };\n\n  static propTypes = {\n    byteArray: TypedArrayProp.uint8\n  };\n\n  renderPDF = dataSet => {\n    const sopClassUid = dataSet.string('x00080016');\n\n    if (sopClassUid !== SOP_CLASS_UIDS.ENCAPSULATED_PDF) {\n      throw new Error('This is not a DICOM-encapsulated PDF');\n    }\n\n    const fileTag = dataSet.elements.x00420011;\n    const offset = fileTag.dataOffset;\n    const remainder = offset + fileTag.length;\n    const pdfByteArray = dataSet.byteArray.slice(offset, remainder);\n    const PDF = new Blob([pdfByteArray], { type: 'application/pdf' });\n    const fileURL = URL.createObjectURL(PDF);\n\n    this.setState({\n      fileURL\n    });\n  };\n\n  parseByteArray = byteArray => {\n    const options = {\n      untilTag: ''\n    };\n\n    let dataSet;\n\n    try {\n      dataSet = dicomParser.parseDicom(byteArray, options);\n    } catch (error) {\n      this.setState({\n        error\n      });\n    }\n\n    return dataSet;\n  };\n\n  componentDidMount() {\n    const dataSet = this.parseByteArray(this.props.byteArray);\n\n    this.renderPDF(dataSet);\n  }\n\n  render() {\n    return (\n      <div\n        className={'DicomPDFViewport'}\n        style={{ width: '100%', height: '100%' }}\n      >\n        {this.state.fileURL && (\n          <object\n            data={this.state.fileURL}\n            type=\"application/pdf\"\n            width=\"100%\"\n            height=\"100%\"\n          />\n        )}\n        {this.state.error && <h2>{JSON.stringify(this.state.error)}</h2>}\n      </div>\n    );\n  }\n}\n\nexport default DicomPDFViewport;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport OHIF from 'ohif-core';\nimport OHIFComponentPlugin from './OHIFComponentPlugin.js';\nimport DicomPDFViewport from './DicomPDFViewport';\n\nconst { DICOMWeb } = OHIF;\n\nclass OHIFDicomPDFViewport extends Component {\n  static propTypes = {\n    studies: PropTypes.object,\n    displaySet: PropTypes.object,\n    viewportIndex: PropTypes.number\n  };\n\n  state = {\n    byteArray: null,\n    error: null\n  };\n\n  static id = 'DicomPDFViewportPDF';\n\n  static init() {\n    console.log('DicomPDFViewport init()');\n  }\n\n  static destroy() {\n    console.log('DicomPDFViewport destroy()');\n  }\n\n  componentDidMount() {\n    const { displaySet } = this.props.viewportData;\n    const { studyInstanceUid, seriesInstanceUid, sopInstanceUid, wadoRoot, wadoUri, authorizationHeaders} = displaySet;\n\n    this.retrieveDicomData(studyInstanceUid, seriesInstanceUid, sopInstanceUid, wadoRoot, wadoUri, authorizationHeaders).then(byteArray => {\n      this.setState({\n        byteArray\n      });\n    }, error => {\n      this.setState({\n        error\n      });\n\n        throw new Error(error);\n      }\n    );\n  }\n\n  retrieveDicomData(studyInstanceUid, seriesInstanceUid, sopInstanceUid, wadoRoot, wadoUri, authorizationHeaders) {\n    // TODO: Passing in a lot of data we aren't using\n\n    // TODO: Authorization header depends on the server. If we ever have multiple servers\n    // we will need to figure out how / when to pass this information in.\n    return fetch(wadoUri, {\n      headers: authorizationHeaders\n    }).then(response => response.arrayBuffer()).then(arraybuffer => {\n      return new Uint8Array(arraybuffer);\n    });\n  }\n\n  render() {\n    const { id, init, destroy } = OHIFDicomPDFViewport;\n    const pluginProps = { id, init, destroy };\n\n    return (\n      <OHIFComponentPlugin {...pluginProps}>\n        {this.state.byteArray && (\n          <DicomPDFViewport byteArray={this.state.byteArray} />\n        )}\n        {this.state.error && <h2>{JSON.stringify(this.state.error)}</h2>}\n      </OHIFComponentPlugin>\n    );\n  }\n}\n\nexport default OHIFDicomPDFViewport;\n","import OHIFDicomPDFSopClassHandler from './OHIFDicomPDFSopClassHandler.js';\nimport OHIFDicomPDFViewport from './OHIFDicomPDFViewport.js';\n\nexport default {\n  /**\n   * Only required property. Should be a unique value across all extensions.\n   */\n  id: 'pdf',\n\n  getViewportModule() {\n    return OHIFDicomPDFViewport;\n  },\n  getSopClassHandlerModule() {\n    return OHIFDicomPDFSopClassHandler;\n  }\n};\n"],"names":["SOP_CLASS_UIDS","ENCAPSULATED_PDF","OHIFDicomPDFSopClassHandler","id","type","MODULE_TYPES","SOP_CLASS_HANDLER","sopClassUids","getDisplaySetFromSeries","series","study","dicomWebClient","authorizationHeaders","instance","getFirstInstance","plugin","displaySetInstanceUid","utils","guid","wadoRoot","getData","wadoUri","wadouri","sopInstanceUid","getSOPInstanceUID","seriesInstanceUid","getSeriesInstanceUID","studyInstanceUid","getStudyInstanceUID","OHIFComponentPlugin","props","React","children","propTypes","PropTypes","string","isRequired","init","func","destroy","node","TypedArrayProp","any","propName","componentName","obj","Float64Array","Float32Array","Int32Array","Int16Array","Int8Array","Uint32Array","Uint16Array","Uint8Array","Uint8ClampedArray","Error","float64","float32","float","int32","int16","int8","int","uint32","uint16","uint8","uint8clamped","uint","DicomPDFViewport","fileURL","error","dataSet","sopClassUid","fileTag","elements","x00420011","offset","dataOffset","remainder","length","pdfByteArray","byteArray","slice","PDF","Blob","URL","createObjectURL","setState","options","untilTag","dicomParser","parseDicom","parseByteArray","renderPDF","width","height","state","JSON","stringify","Component","DICOMWeb","OHIF","OHIFDicomPDFViewport","displaySet","viewportData","retrieveDicomData","then","fetch","headers","response","arrayBuffer","arraybuffer","pluginProps","console","log","studies","object","viewportIndex","number","getViewportModule","getSopClassHandlerModule"],"mappings":"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"}