{"version":3,"file":"react-nprogress.js","sources":["../src/clamp.ts","../src/increment.ts","../src/queue.ts","../src/timeout.ts","../src/NProgress.tsx","../src/withNProgress.tsx"],"sourcesContent":["export const clamp = (num: number, lower: number, upper: number) => {\n  num = num <= upper ? num : upper\n  num = num >= lower ? num : lower\n  return num\n}\n","import { clamp } from './clamp'\n\nexport const increment = (progress: number) => {\n  let amount = 0\n\n  if (progress >= 0 && progress < 0.2) {\n    amount = 0.1\n  } else if (progress >= 0.2 && progress < 0.5) {\n    amount = 0.04\n  } else if (progress >= 0.5 && progress < 0.8) {\n    amount = 0.02\n  } else if (progress >= 0.8 && progress < 0.99) {\n    amount = 0.005\n  }\n\n  return clamp(progress + amount, 0, 0.994)\n}\n","type Next = () => void\ntype Callback = (next: Next) => void\n\nlet isRunning = false\nlet pending: Callback[] = []\n\nconst next: Next = () => {\n  isRunning = true\n  const cb = pending.shift()\n  if (cb) {\n    return cb(next)\n  }\n  isRunning = false\n}\n\nexport const clear = () => {\n  isRunning = false\n  pending = []\n}\n\nexport const queue = (cb: Callback) => {\n  pending.push(cb)\n  if (!isRunning && pending.length === 1) {\n    next()\n  }\n}\n","let handle: number | undefined\n\nexport const cancel = () => {\n  if (handle) {\n    window.cancelAnimationFrame(handle)\n  }\n}\n\nexport const timeout = (callback: () => void, delay: number) => {\n  let deltaTime\n  let start: number | undefined\n\n  const frame: FrameRequestCallback = time => {\n    start = start || time\n    deltaTime = time - start\n    if (deltaTime > delay) {\n      callback()\n      return\n    }\n    handle = window.requestAnimationFrame(frame)\n  }\n\n  handle = window.requestAnimationFrame(frame)\n}\n","import * as PropTypes from 'prop-types'\nimport * as React from 'react'\nimport { clamp } from './clamp'\nimport { increment } from './increment'\nimport { clear as clearQueue, queue } from './queue'\nimport { cancel as cancelCurrentTimeout, timeout } from './timeout'\n\nexport interface Props {\n  animationDuration: number\n  children: (renderProps: RenderProps) => React.ReactNode\n  incrementDuration: number\n  isAnimating: boolean\n  minimum: number\n}\n\nexport interface State {\n  isFinished: boolean\n  progress: number\n}\n\nexport type RenderProps = State & Pick<Props, 'animationDuration'>\n\nexport class NProgress extends React.Component<Props, State> {\n  static defaultProps = {\n    animationDuration: 200,\n    incrementDuration: 800,\n    isAnimating: false,\n    minimum: 0.08\n  }\n\n  static propTypes = {\n    animationDuration: PropTypes.number,\n    children: PropTypes.func,\n    incrementDuration: PropTypes.number,\n    isAnimating: PropTypes.bool,\n    minimum: PropTypes.number\n  }\n\n  initialState = {\n    isFinished: false,\n    progress: 0\n  }\n\n  state = this.initialState\n\n  start() {\n    const work = () => {\n      this.trickle()\n      queue(next => {\n        timeout(() => {\n          work()\n          next()\n        }, this.props.incrementDuration)\n      })\n    }\n\n    work()\n  }\n\n  trickle() {\n    this.set(increment(this.state.progress))\n  }\n\n  set(n: number) {\n    n = clamp(n, this.props.minimum, 1)\n\n    if (n === 1) {\n      this.cleanup()\n\n      queue(next => {\n        this.setState(\n          () => ({ progress: n }),\n          () => timeout(next, this.props.animationDuration)\n        )\n      })\n\n      queue(() => {\n        this.setState(() => ({ isFinished: true }), this.cleanup)\n      })\n\n      return\n    }\n\n    queue(next => {\n      this.setState(\n        () => ({ progress: n }),\n        () => timeout(next, this.props.animationDuration)\n      )\n    })\n  }\n\n  cleanup() {\n    cancelCurrentTimeout()\n    clearQueue()\n  }\n\n  done() {\n    this.set(1)\n  }\n\n  componentDidMount() {\n    if (this.props.isAnimating) {\n      this.start()\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.isAnimating && !this.props.isAnimating) {\n      this.done()\n    }\n\n    if (!prevProps.isAnimating && this.props.isAnimating) {\n      this.setState(() => this.initialState, () => this.start())\n    }\n  }\n\n  componentWillUnmount() {\n    this.cleanup()\n  }\n\n  render() {\n    return this.props.children({\n      ...this.state,\n      animationDuration: this.props.animationDuration\n    })\n  }\n}\n","import hoistNonReactStatics from 'hoist-non-react-statics'\nimport * as React from 'react'\nimport { NProgress, Props, RenderProps } from './NProgress'\n\ntype EnhancedProps<P> = P &\n  Partial<Pick<Props, Exclude<keyof Props, 'children'>>>\n\nexport function withNProgress<P>(\n  BaseComponent: React.ComponentType<EnhancedProps<P>>\n) {\n  const WithNProgress: React.FC<EnhancedProps<P>> = props => (\n    <NProgress {...props}>\n      {(p: RenderProps) => <BaseComponent {...props} {...p} />}\n    </NProgress>\n  )\n\n  hoistNonReactStatics(WithNProgress, BaseComponent)\n\n  return WithNProgress\n}\n"],"names":["clamp","num","lower","upper","increment","progress","amount","isRunning","pending","next","cb","shift","clear","queue","push","length","handle","cancel","window","cancelAnimationFrame","timeout","callback","delay","deltaTime","start","frame","time","requestAnimationFrame","NProgress","initialState","isFinished","state","work","trickle","props","incrementDuration","set","n","minimum","cleanup","setState","animationDuration","cancelCurrentTimeout","clearQueue","done","componentDidMount","isAnimating","componentDidUpdate","prevProps","componentWillUnmount","render","children","React","defaultProps","propTypes","PropTypes","withNProgress","BaseComponent","WithNProgress","React.createElement","p","hoistNonReactStatics"],"mappings":"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"}